dist: xenial
language: python
sudo: false
python:
- 3.8
- 3.7
- 3.6
- 3.9-dev
# blocklist branches
branches:
  except:
  - requires-io-master
  - /^dependabot.*$/
install:
- pip install -r requirements-test.txt
- pip install .[babel] coveralls wheel
script:
- py.test -v --cov pyramid_localize tests/
after_success:
    - coveralls
jobs:
  allow_failures:
  - python: 3.9-dev
  include:
  - stage: linters
    install:
    - pip install -r requirements-lint.txt
    - pip install .[tests]
    script:
    - pycodestyle
    - pydocstyle
    - pylint pyramid_localize tests
    after_success: skip
  - stage: deploy
    if: tag IS present
    script: skip
    deploy:
      provider: pypi
      user: fizyk
      password:
        secure: DwNZeHXX6sLDVUZpRGy866jP1IuScKOqrYdQ3FmceDn2bRVfH3ebMzVQJLlOlqVizuR+SxhJ0W+/gfWdGxog2dDpEquUolNXx8S85I1GQaoUqqrMt8z9LqLIYjtgumMUczVvnWc7tQ0GFKrmQzjXxVfBxaFSjwB5BBgmWJXE+UY=
      on:
        tags: true
        repo: fizyk/pyramid_localize
      distributions: bdist_wheel
